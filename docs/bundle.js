(()=>{"use strict";var e={16:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,"/* Stili personalizzati per Owly */\n\n:root {\n  --owly-primary: #4e73df;\n  --owly-secondary: #f8f9fc;\n  --owly-accent: #f6c23e;\n}\n\nbody {\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n  background-color: #f8f9fc;\n  color: #333;\n}\n\n.card {\n  transition: transform 0.3s ease;\n  border-radius: 10px;\n  overflow: hidden;\n}\n\n.card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 10px 20px rgba(0,0,0,0.1);\n}\n\n.btn-primary {\n  background-color: var(--owly-primary);\n  border-color: var(--owly-primary);\n}\n\n.btn-primary:hover {\n  background-color: #375ad3;\n  border-color: #375ad3;\n}\n\n.book-card {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.book-card .card-body {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.book-card .card-title {\n  font-weight: 600;\n  margin-bottom: 10px;\n}\n\n.book-card .book-authors {\n  color: #666;\n  font-style: italic;\n  margin-bottom: auto;\n}\n\n.book-card .card-footer {\n  background-color: var(--owly-secondary);\n  border-top: 1px solid rgba(0,0,0,0.05);\n}\n\n#search-input:focus {\n  box-shadow: 0 0 0 0.25rem rgba(78, 115, 223, 0.25);\n  border-color: #bac8f3;\n}\n\n.modal-content {\n  border-radius: 10px;\n  overflow: hidden;\n}\n\n.modal-header {\n  background-color: var(--owly-primary);\n  color: white;\n}\n\n.book-cover {\n  max-width: 100%;\n  border-radius: 5px;\n  box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n}\n\n.text-primary {\n  color: var(--owly-primary) !important;\n}\n\n/* Stili per animazioni */\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n.fadeIn {\n  animation: fadeIn 0.5s ease-in-out;\n}\n\n/* Stili responsive */\n@media (max-width: 768px) {\n  .container {\n    padding-left: 15px;\n    padding-right: 15px;\n  }\n}\n",""]);const s=i},56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],l=o.base?c[0]+o.base:c[0],d=a[l]||0,u="".concat(l," ").concat(d);a[l]=d+1;var p=t(u),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)n[p].references++,n[p].updater(m);else{var b=r(m,o);o.byIndex=s,n.splice(s,0,{identifier:u,updater:b,references:1})}i.push(u)}return i}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var a=o(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=t(a[i]);n[s].references--}for(var c=o(e,r),l=0;l<a.length;l++){var d=t(a[l]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}a=c}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);o&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),n.push(d))}},n}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var a=n[o]={id:o,exports:{}};return e[o](a,a.exports,t),a.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;const o="https://openlibrary.org",r=(e,n="M")=>e?`https://covers.openlibrary.org/b/id/${e}-${["S","M","L"].includes(n)?n:"M"}.jpg`:null;var a=t(72),i=t.n(a),s=t(825),c=t.n(s),l=t(659),d=t.n(l),u=t(56),p=t.n(u),m=t(540),b=t.n(m),f=t(113),g=t.n(f),h=t(16),v={};let y;v.styleTagTransform=g(),v.setAttributes=p(),v.insert=d().bind(null,"head"),v.domAPI=c(),v.insertStyleElement=b(),i()(h.A,v),h.A&&h.A.locals&&h.A.locals;let w,x,k,E,$,L,I,T,M,j,C,A,N=1,B=1,S=[];async function z(){R(!0);try{const e=await(async(e=100)=>{try{const n=["fiction","fantasy","science","history","biography","romance","mystery","thriller"],t=n[Math.floor(Math.random()*n.length)];console.log("Fetching trending books from category:",t);const r=`${o}/subjects/${t}.json?limit=${e}`,a=new AbortController,i=setTimeout((()=>a.abort()),1e4),s=await fetch(r,{signal:a.signal,headers:{Accept:"application/json"}});if(clearTimeout(i),!s.ok)throw new Error(`Errore nel recupero dei libri in tendenza: ${s.status}`);const c=await s.json();return console.log("Trending books response:",c),c}catch(e){throw console.error("Errore durante il recupero dei libri in tendenza:",e),e}})();e&&e.works&&e.works.length>0?(S=e.works,B=Math.ceil(S.length/12),D(),F(P(),"Libri in evidenza")):_(!0,"Nessun libro disponibile al momento. Prova a cercare un titolo o una categoria.")}catch(e){U(`Errore durante il caricamento dei libri: ${e.message}`)}finally{R(!1)}}async function H(){const e=w.value.trim();if(e){R(!0),T.classList.add("d-none"),N=1;try{const n=await(async e=>{try{if(!e)throw new Error("Categoria non specificata");const n=encodeURIComponent(e.trim().toLowerCase()),t=`${o}/subjects/${n}.json?limit=100`;console.log("Fetching books from URL:",t);const r=new AbortController,a=setTimeout((()=>r.abort()),1e4),i=await fetch(t,{signal:r.signal,headers:{Accept:"application/json"}});if(clearTimeout(a),!i.ok)throw new Error(`Errore nella ricerca: ${i.status}`);const s=await i.json();return console.log("API response:",s),s}catch(e){throw console.error("Errore durante il recupero dei libri:",e),e}})(e);n&&n.works&&n.works.length>0?(S=n.works,B=Math.ceil(S.length/12),D(),F(P(),`Risultati per "${e}"`)):_(!0,`Nessun risultato trovato per "${e}". Prova con un'altra categoria o titolo.`)}catch(e){U(`Errore durante la ricerca: ${e.message}`)}finally{R(!1)}}else z()}function P(){const e=12*(N-1),n=Math.min(e+12,S.length);return S.slice(e,n)}function O(e){e<1||e>B||(N=e,D(),F(P()),window.scrollTo({top:document.getElementById("search-input").offsetTop-20,behavior:"smooth"}))}function D(){C.textContent=N.toString(),A.textContent=`Pagina ${N} di ${B}`,M.classList.toggle("disabled",N<=1),j.classList.toggle("disabled",N>=B),T.classList.toggle("d-none",B<=1)}function F(e,n=""){if(k.innerHTML="",_(!1),n){const e=document.createElement("div");e.className="col-12 mb-4",e.innerHTML=`<h3 class="fw-light">${n}</h3>`,k.appendChild(e)}e.forEach((e=>{const n=function(e){const n=document.createElement("div");n.className="col-md-4 col-lg-3 mb-4";const{title:t,authors:a,cover_id:i,key:s}=e,c=t.length>40?`${t.substring(0,37)}...`:t,l=a?a.map((e=>e.name)).join(", "):"Autore sconosciuto",d=i?r(i):"https://placehold.co/200x300/e9e9e9/7d7d7d?text=Nessuna+copertina";return n.innerHTML=`\n    <div class="card h-100 book-card">\n      <img src="${d}" class="card-img-top" alt="${t}" style="height: 250px; object-fit: cover;">\n      <div class="card-body">\n        <h5 class="card-title" title="${t}">${c}</h5>\n        <p class="book-authors">${l}</p>\n      </div>\n      <div class="card-footer">\n        <button class="btn btn-primary btn-sm view-details w-100" data-key="${s}">\n          <i class="bi bi-info-circle me-1"></i> Dettagli\n        </button>\n      </div>\n    </div>\n  `,n.querySelector(".view-details").addEventListener("click",(()=>{!async function(e){L.innerHTML='\n    <div class="text-center">\n      <div class="spinner-border text-primary" role="status">\n        <span class="visually-hidden">Caricamento...</span>\n      </div>\n    </div>\n  ',y.show();try{const n=await(async e=>{try{if(!e)throw new Error("Chiave del libro non specificata");const n=e.startsWith("/works/")?e:`/works/${e}`,t=`${o}${n}.json`,r=await fetch(t);if(!r.ok)throw new Error(`Errore nel recupero dei dettagli: ${r.status}`);return await r.json()}catch(e){throw console.error("Errore durante il recupero dei dettagli del libro:",e),e}})(e);console.log("Book details:",n),I.textContent=n.title||"Dettagli del libro";let t="Nessuna descrizione disponibile.";n.description&&(t="string"==typeof n.description?n.description:n.description.value||"Nessuna descrizione disponibile.");const a=n.covers&&n.covers.length>0?r(n.covers[0],"L"):"https://placehold.co/400x600/e9e9e9/7d7d7d?text=Nessuna+copertina",i=n.subjects?n.subjects.slice(0,10).join(", "):"Non disponibili";let s="Non disponibile";if(n.ebooks&&n.ebooks.length>0){const e=[];n.ebooks.forEach((n=>{n.formats&&Object.keys(n.formats).forEach((n=>{e.includes(n)||e.push(n)}))})),s=e.length>0?e.join(", "):"Solo formato cartaceo"}let c="Non disponibile";if(n.languages){const e={eng:"Inglese",ita:"Italiano",spa:"Spagnolo",fre:"Francese",ger:"Tedesco",rus:"Russo",chi:"Cinese",jpn:"Giapponese",por:"Portoghese",ara:"Arabo"},t=Array.isArray(n.languages)?n.languages:[n.language];t&&t.length>0&&(c=t.map((n=>{const t=("object"==typeof n?n.key:n).split("/").pop().toLowerCase();return e[t]||t})).join(", "))}const l=(e,n,t="Non disponibile")=>{try{return n.split(".").reduce(((e,n)=>e&&e[n]),e)||t}catch(e){return t}},d=l(n,"first_publish_date","Data sconosciuta");l(n,"publishers.0.name","Editore sconosciuto"),L.innerHTML=`\n      <div class="row">\n        <div class="col-md-4 mb-3 mb-md-0">\n          <img src="${a}" alt="${n.title}" class="book-cover w-100">\n          \n          <div class="mt-3">\n            <div class="card">\n              <div class="card-header bg-light">\n                <h6 class="mb-0">Informazioni tecniche</h6>\n              </div>\n              <ul class="list-group list-group-flush">\n                <li class="list-group-item d-flex">\n                  <span class="fw-bold me-2"><i class="bi bi-translate me-2"></i>Lingue:</span> \n                  <span class="ms-auto">${c}</span>\n                </li>\n                <li class="list-group-item d-flex">\n                  <span class="fw-bold me-2"><i class="bi bi-journal me-2"></i>Formato:</span> \n                  <span class="ms-auto">${s}</span>\n                </li>\n                <li class="list-group-item d-flex">\n                  <span class="fw-bold me-2"><i class="bi bi-calendar-event me-2"></i>Pubblicazione:</span> \n                  <span class="ms-auto">${d}</span>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-8">\n          <h4>${n.title}</h4>\n          <p class="text-muted">${n.subtitle||""}</p>\n          \n          <div class="mb-3">\n            <span class="badge bg-primary">${c.split(",")[0]}</span>\n            ${i.split(",").slice(0,3).map((e=>`<span class="badge bg-secondary">${e.trim()}</span>`)).join(" ")}\n          </div>\n          \n          <h6 class="mt-4 mb-2 border-bottom pb-2">Descrizione</h6>\n          <p>${t}</p>\n          \n          <h6 class="mt-4 mb-2 border-bottom pb-2">Genere e Categorie</h6>\n          <p>${i}</p>\n          \n          <div class="mt-4">\n            <a href="https://openlibrary.org${e}" target="_blank" class="btn btn-outline-primary btn-sm">\n              <i class="bi bi-box-arrow-up-right me-1"></i> Vedi su Open Library\n            </a>\n          </div>\n        </div>\n      </div>\n    `}catch(e){L.innerHTML=`\n      <div class="alert alert-danger">\n        Si è verificato un errore durante il recupero dei dettagli del libro: ${e.message}\n      </div>\n    `}}(s)})),n}(e);k.appendChild(n)}));const t=S.length,a=12*(N-1)+1,i=Math.min(a+e.length-1,t),s=document.createElement("div");s.className="col-12 text-center mt-4",s.innerHTML=`\n    <p class="text-muted">\n      Visualizzazione risultati ${a}-${i} di ${t}\n    </p>\n  `,k.appendChild(s),k.classList.add("fadeIn")}function R(e){E.classList.toggle("d-none",!e)}function _(e,n="Nessun risultato trovato. Prova con un'altra categoria."){$.classList.toggle("d-none",!e),e&&($.innerHTML=`<p class="lead">${n}</p>`,k.innerHTML="")}function U(e){const n=document.createElement("div");n.className="alert alert-danger alert-dismissible fade show",n.setAttribute("role","alert"),n.innerHTML=`\n    ${e}\n    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Chiudi"></button>\n  `,k.parentNode.insertBefore(n,k),setTimeout((()=>{n.classList.remove("show"),setTimeout((()=>n.remove()),300)}),5e3)}document.addEventListener("DOMContentLoaded",(function(){w=document.getElementById("search-input"),x=document.getElementById("search-button"),k=document.getElementById("books-container"),E=document.getElementById("loading"),$=document.getElementById("no-results");const e=document.getElementById("book-modal");L=document.getElementById("book-details"),I=document.getElementById("book-modal-label"),T=document.getElementById("pagination-controls"),M=document.getElementById("prev-page"),j=document.getElementById("next-page"),C=document.getElementById("current-page"),A=document.getElementById("pagination-info"),"undefined"!=typeof bootstrap?y=new bootstrap.Modal(e):console.error("Bootstrap non è stato caricato correttamente!"),x.addEventListener("click",H),w.addEventListener("keypress",(e=>{"Enter"===e.key&&H()})),M.addEventListener("click",(()=>{N>1&&O(N-1)})),j.addEventListener("click",(()=>{N<B&&O(N+1)})),z()}))})();